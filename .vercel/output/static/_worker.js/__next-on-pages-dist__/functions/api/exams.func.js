var W=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var J=Object.prototype.hasOwnProperty;var Q=(l,d)=>()=>(l&&(d=l(l=0)),d);var H=(l,d,P,m)=>{if(d&&typeof d=="object"||typeof d=="function")for(let f of z(d))!J.call(l,f)&&f!==P&&W(l,f,{get:()=>d[f],enumerable:!(m=Y(d,f))||m.enumerable});return l},q=(l,d,P)=>(H(l,d,"default"),P&&H(P,d,"default"));var Z=l=>H(W({},"__esModule",{value:!0}),l);var F={};import*as dt from"async_hooks";var V=Q(()=>{q(F,dt)});import{__getNamedExports as ee}from"../../../__next-on-pages-dist__/webpack/9802cf9bbc098bad310494fcc153465f.js";import{__getNamedExports as te}from"../../../__next-on-pages-dist__/manifest/27d10e462fba646daaa29468a0656e12.js";import"../../../__next-on-pages-dist__/wasm/wasm_848bce377ad47c933e205bdb413ae8af5ac0ccf0.wasm";var w=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/exams"),t=ee(w,w,w),ne=t.__chunk_1146,_e=t.__chunk_6195,ae=t.__chunk_2067,re=t.__chunk_5486,oe=t.__chunk_7223,ce=t.__chunk_1548,se=t.__chunk_2780,ue=t.__chunk_5612,ie=t.__chunk_2262,le=t.__chunk_1465,de=t.__chunk_1869,he=t.__chunk_5524,pe=t.__chunk_8536,ke=t.__chunk_6765,ye=t.__chunk_9814,me=t.__chunk_9859,fe=t.__chunk_9307,ge=t.__chunk_74,xe=t.__chunk_4123,Ne=t.__chunk_3412,Ee=t.__chunk_8978,ve=t.__chunk_1812,Re=t.__chunk_1673,Te=t.__chunk_7398,we=t.__chunk_5376,be=t.__chunk_6617,Oe=t.__chunk_5767,Ae=t.__chunk_8260,Ie=t.__chunk_5027,Se=t.__chunk_2738,je=t.__chunk_2113,Pe=t.__chunk_5065,Me=t.__chunk_5514,Ce=t.__chunk_2860,Fe=t.__chunk_5257,De=t.__chunk_8427,$e=t.__chunk_8997,Le=t.__chunk_8024,Be=t.__chunk_2403,Ue=t.__chunk_8690,Ke=t.__chunk_6265,He=t.__chunk_5492,qe=t.__chunk_3059,Ge=t.__chunk_8610,Xe=t.__chunk_7959,We=t.__chunk_4303,Ve=t.__chunk_3326,Ye=t.__chunk_391,ze=t.__chunk_8789,Je=t.__chunk_552,Qe=t.__chunk_7649,Ze=t.__chunk_2501,et=t.__chunk_6443,tt=t.__chunk_1616,nt=t.__chunk_2034,_t=t.__chunk_3131,at=t.__chunk_2328,rt=t.__chunk_8908,ot=t.__chunk_1713,ct=t.__chunk_1172,G=te(w,w,w),st=G.__NEXT_FONT_MANIFEST,ut=G.__REACT_LOADABLE_MANIFEST,it=G.__BUILD_MANIFEST,mt=((l,d,P)=>(d._ENTRIES={},l.__BUILD_MANIFEST=it,l.__REACT_LOADABLE_MANIFEST=ut,l.__NEXT_FONT_MANIFEST=st,l.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",l.__PRERENDER_MANIFEST='{"version":4,"routes":{"/":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/page,_N_T_/"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/","dataRoute":"/index.rsc"},"/scores/import":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/scores/layout,_N_T_/scores/import/layout,_N_T_/scores/import/page,_N_T_/scores/import"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/scores/import","dataRoute":"/scores/import.rsc"},"/management":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/management/layout,_N_T_/management/page,_N_T_/management"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/management","dataRoute":"/management.rsc"},"/analysis/student":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/analysis/layout,_N_T_/analysis/student/layout,_N_T_/analysis/student/page,_N_T_/analysis/student"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/analysis/student","dataRoute":"/analysis/student.rsc"},"/analysis/class":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/analysis/layout,_N_T_/analysis/class/layout,_N_T_/analysis/class/page,_N_T_/analysis/class"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/analysis/class","dataRoute":"/analysis/class.rsc"},"/scores/add":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/scores/layout,_N_T_/scores/add/layout,_N_T_/scores/add/page,_N_T_/scores/add"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/scores/add","dataRoute":"/scores/add.rsc"}},"dynamicRoutes":{},"notFoundRoutes":[],"preview":{"previewModeId":"process.env.__NEXT_PREVIEW_MODE_ID","previewModeSigningKey":"process.env.__NEXT_PREVIEW_MODE_SIGNING_KEY","previewModeEncryptionKey":"process.env.__NEXT_PREVIEW_MODE_ENCRYPTION_KEY"}}',(()=>{"use strict";var m={},f={};function a(n){var s=f[n];if(s!==void 0)return s.exports;var _=f[n]={id:n,loaded:!1,exports:{}},h=!0;try{m[n](_,_.exports,a),h=!1}finally{h&&delete f[n]}return _.loaded=!0,_.exports}a.m=m,a.amdO={},(()=>{var n=[];a.O=(s,_,h,k)=>{if(_){k=k||0;for(var i=n.length;i>0&&n[i-1][2]>k;i--)n[i]=n[i-1];n[i]=[_,h,k];return}for(var u=1/0,i=0;i<n.length;i++){for(var[_,h,k]=n[i],y=!0,E=0;E<_.length;E++)u>=k&&Object.keys(a.O).every(j=>a.O[j](_[E]))?_.splice(E--,1):(y=!1,k<u&&(u=k));if(y){n.splice(i--,1);var v=h();v!==void 0&&(s=v)}}return s}})(),a.n=n=>{var s=n&&n.__esModule?()=>n.default:()=>n;return a.d(s,{a:s}),s},(()=>{var n,s=Object.getPrototypeOf?_=>Object.getPrototypeOf(_):_=>_.__proto__;a.t=function(_,h){if(1&h&&(_=this(_)),8&h||typeof _=="object"&&_&&(4&h&&_.__esModule||16&h&&typeof _.then=="function"))return _;var k=Object.create(null);a.r(k);var i={};n=n||[null,s({}),s([]),s(s)];for(var u=2&h&&_;typeof u=="object"&&!~n.indexOf(u);u=s(u))Object.getOwnPropertyNames(u).forEach(y=>i[y]=()=>_[y]);return i.default=()=>_,a.d(k,i),k}})(),a.d=(n,s)=>{for(var _ in s)a.o(s,_)&&!a.o(n,_)&&Object.defineProperty(n,_,{enumerable:!0,get:s[_]})},a.e=()=>Promise.resolve(),a.g=function(){if(typeof d=="object")return d;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),a.o=(n,s)=>Object.prototype.hasOwnProperty.call(n,s),a.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},a.nmd=n=>(n.paths=[],n.children||(n.children=[]),n),(()=>{var n={993:0};a.O.j=h=>n[h]===0;var s=(h,k)=>{var i,u,[y,E,v]=k,O=0;if(y.some(C=>n[C]!==0)){for(i in E)a.o(E,i)&&(a.m[i]=E[i]);if(v)var M=v(a)}for(h&&h(k);O<y.length;O++)u=y[O],a.o(n,u)&&n[u]&&n[u][0](),n[u]=0;return a.O(M)},_=l.webpackChunk_N_E=l.webpackChunk_N_E||[];_.forEach(s.bind(null,0)),_.push=s.bind(null,_.push.bind(_))})()})(),(l.webpackChunk_N_E=l.webpackChunk_N_E||[]).push([[962],{1172:ct,1713:ot,8908:rt,2328:at,3131:_t,2034:nt,1616:tt,6443:et,2501:Ze,7649:Qe,552:Je,8789:ze,391:Ye,3326:Ve,4303:We,7959:Xe,8610:Ge,3059:qe,5492:He,6265:Ke,8690:Ue,2403:Be,8024:Le,8997:$e,8427:De,5257:Fe,2860:Ce,5514:Me,5065:Pe,2113:je,2738:Se,5027:Ie,8260:Ae,5767:Oe,6617:be,5376:we,7398:Te,1673:Re,1812:ve,8978:Ee,3412:Ne,4123:xe,74:ge,9307:fe,9859:me,9814:ye,6765:ke,8536:pe,5524:he,1869:de,1465:le,2262:ie,5612:ue,2780:se,1548:ce,7223:oe,5486:re}]),(l.webpackChunk_N_E=l.webpackChunk_N_E||[]).push([[175],{2067:ae,6195:_e,2513:(m,f,a)=>{"use strict";a.r(f),a.d(f,{ComponentMod:()=>U,default:()=>K});var n={};a.r(n),a.d(n,{DELETE:()=>C,GET:()=>v,POST:()=>O,PUT:()=>M,runtime:()=>E});var s={};a.r(s),a.d(s,{originalPathname:()=>L,patchFetch:()=>B,requestAsyncStorage:()=>j,routeModule:()=>A,serverHooks:()=>$,staticGenerationAsyncStorage:()=>D});var _=a(8260),h=a(5514),k=a(2860),i=a(2113),u=a(5492),y=a(1146);let E="edge";async function v(x,g){let p=(0,y.N)(g);try{let e=await p.exam.findMany({orderBy:{date:"desc"}});return u.xk.json(e)}catch(e){return console.error("\u83B7\u53D6\u8003\u8BD5\u6570\u636E\u5931\u8D25:",e),u.xk.json({error:"\u83B7\u53D6\u8003\u8BD5\u6570\u636E\u5931\u8D25"},{status:500})}finally{g?.env?.DB||await p.$disconnect()}}async function O(x,g){let p=(0,y.N)(g);try{let{name:e,date:c}=await x.json();if(!e||e.trim()===""||!c)return u.xk.json({error:"\u8003\u8BD5\u540D\u79F0\u548C\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A"},{status:400});let r=await p.exam.create({data:{name:e.trim(),date:new Date(c)}});return u.xk.json(r)}catch(e){return console.error("\u521B\u5EFA\u8003\u8BD5\u5931\u8D25:",e),u.xk.json({error:"\u521B\u5EFA\u8003\u8BD5\u5931\u8D25"},{status:500})}finally{g?.env?.DB||await p.$disconnect()}}async function M(x,g){let p=(0,y.N)(g);try{let{id:e,name:c,date:r}=await x.json();if(!e||!c||c.trim()===""||!r)return u.xk.json({error:"\u8003\u8BD5ID\u3001\u540D\u79F0\u548C\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A"},{status:400});let o=await p.exam.update({where:{id:parseInt(e)},data:{name:c.trim(),date:new Date(r)}});return u.xk.json(o)}catch(e){return console.error("\u66F4\u65B0\u8003\u8BD5\u5931\u8D25:",e),u.xk.json({error:"\u66F4\u65B0\u8003\u8BD5\u5931\u8D25"},{status:500})}finally{g?.env?.DB||await p.$disconnect()}}async function C(x,g){let p=(0,y.N)(g);try{let e=x.nextUrl.searchParams.get("id");if(!e)return u.xk.json({error:"\u8003\u8BD5ID\u4E0D\u80FD\u4E3A\u7A7A"},{status:400});let c=await p.exam.findUnique({where:{id:parseInt(e)},include:{scores:!0}});return c&&c.scores.length>0?u.xk.json({error:"\u4E0D\u80FD\u5220\u9664\u6709\u6210\u7EE9\u8BB0\u5F55\u7684\u8003\u8BD5\uFF0C\u8BF7\u5148\u5220\u9664\u76F8\u5173\u6210\u7EE9"},{status:400}):(await p.exam.delete({where:{id:parseInt(e)}}),u.xk.json({message:"\u8003\u8BD5\u5220\u9664\u6210\u529F"}))}catch(e){return console.error("\u5220\u9664\u8003\u8BD5\u5931\u8D25:",e),u.xk.json({error:"\u5220\u9664\u8003\u8BD5\u5931\u8D25"},{status:500})}finally{g?.env?.DB||await p.$disconnect()}}let A=new h.AppRouteRouteModule({definition:{kind:k.x.APP_ROUTE,page:"/api/exams/route",pathname:"/api/exams",filename:"route",bundlePath:"app/api/exams/route"},resolvedPagePath:"/Users/ryan/demo2/AI/Grade_M2/src/app/api/exams/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:j,staticGenerationAsyncStorage:D,serverHooks:$}=A,L="/api/exams/route";function B(){return(0,i.XH)({serverHooks:$,staticGenerationAsyncStorage:D})}let U=s,K=_.a.wrap(A)},1146:ne},m=>{var f=n=>m(m.s=n);m.O(0,[962],()=>f(2513));var a=m.O();(d._ENTRIES=typeof d._ENTRIES>"u"?{}:d._ENTRIES)["middleware_app/api/exams/route"]=a}]),function(){let m={exports:{},loaded:!1};return function(a,n){var s=Object.create,_=Object.defineProperty,h=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyNames,i=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,y=e=>_(e,"__esModule",{value:!0}),E=(e,c)=>{y(e);for(var r in c)_(e,r,{get:c[r],enumerable:!0})},v=(e,c,r)=>{if(c&&typeof c=="object"||typeof c=="function")for(let o of k(c))!u.call(e,o)&&o!=="default"&&_(e,o,{get:()=>c[o],enumerable:!(r=h(c,o))||r.enumerable});return e},O=e=>v(y(_(e!=null?s(i(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);E(n,{default:()=>K});var M=O((V(),Z(F))),C="@next/request-context",A=Symbol.for(C),j=Symbol.for("internal.storage");function D(){let e=d;if(!e[A]){let c=new M.AsyncLocalStorage,r={get:()=>c.getStore(),[j]:c};e[A]=r}return e[A]}var $=D();function L(e,c){return $[j].run(e,c)}function B(e){let c={};return e&&e.forEach((r,o)=>{c[o]=r,o.toLowerCase()==="set-cookie"&&(c[o]=U(r))}),c}function U(e){let c=[],r=0,o,R,N,I,S;function T(){for(;r<e.length&&/\s/.test(e.charAt(r));)r+=1;return r<e.length}function b(){return R=e.charAt(r),R!=="="&&R!==";"&&R!==","}for(;r<e.length;){for(o=r,S=!1;T();)if(R=e.charAt(r),R===","){for(N=r,r+=1,T(),I=r;r<e.length&&b();)r+=1;r<e.length&&e.charAt(r)==="="?(S=!0,r=I,c.push(e.substring(o,N)),o=r):r=N+1}else r+=1;(!S||r>=e.length)&&c.push(e.substring(o,e.length))}return c}function K(e){let c=e.staticRoutes.map(o=>({regexp:new RegExp(o.namedRegex),page:o.page})),r=e.dynamicRoutes?.map(o=>({regexp:new RegExp(o.namedRegex),page:o.page}))||[];return async function(o,R){let N=new URL(o.url).pathname,I={};if(e.nextConfig?.basePath&&N.startsWith(e.nextConfig.basePath)&&(N=N.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let T of e.nextConfig.i18n.locales){let b=new RegExp(`^/${T}($|/)`,"i");if(N.match(b)){N=N.replace(b,"/")||"/";break}}for(let T of c)if(T.regexp.exec(N)){I.name=T.page;break}if(!I.name){let T=g(N);for(let b of r||[]){if(T&&!g(b.page))continue;let X=b.regexp.exec(N);if(X){I={name:b.page,params:X.groups};break}}}let S=await L({waitUntil:R.waitUntil},()=>d._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:o.url,method:o.method,headers:B(o.headers),ip:x(o.headers,p.Ip),geo:{city:x(o.headers,p.City,!0),country:x(o.headers,p.Country,!0),latitude:x(o.headers,p.Latitude),longitude:x(o.headers,p.Longitude),region:x(o.headers,p.Region,!0)},nextConfig:e.nextConfig,page:I,body:o.body}}));return S.waitUntil&&R.waitUntil(S.waitUntil),S.response}}function x(e,c,r=!1){let o=e.get(c)||void 0;return r&&o?decodeURIComponent(o):o}function g(e){return e==="/api"||e.startsWith("/api/")}var p;(function(e){e.City="x-vercel-ip-city",e.Country="x-vercel-ip-country",e.Ip="x-real-ip",e.Latitude="x-vercel-ip-latitude",e.Longitude="x-vercel-ip-longitude",e.Region="x-vercel-ip-country-region"})(p||(p={}))}(m,m.exports),m.exports}.call({}).default({name:"app/api/exams/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/analysis/class",regex:"^/analysis/class(?:/)?$",routeKeys:{},namedRegex:"^/analysis/class(?:/)?$"},{page:"/analysis/student",regex:"^/analysis/student(?:/)?$",routeKeys:{},namedRegex:"^/analysis/student(?:/)?$"},{page:"/management",regex:"^/management(?:/)?$",routeKeys:{},namedRegex:"^/management(?:/)?$"},{page:"/scores/add",regex:"^/scores/add(?:/)?$",routeKeys:{},namedRegex:"^/scores/add(?:/)?$"},{page:"/scores/import",regex:"^/scores/import(?:/)?$",routeKeys:{},namedRegex:"^/scores/import(?:/)?$"}],dynamicRoutes:[],nextConfig:{basePath:""}})))(w,w,w);export{mt as default};
