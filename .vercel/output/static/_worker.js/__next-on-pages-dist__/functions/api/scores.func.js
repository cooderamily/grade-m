var W=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var J=Object.prototype.hasOwnProperty;var Q=(l,h)=>()=>(l&&(h=l(l=0)),h);var H=(l,h,P,m)=>{if(h&&typeof h=="object"||typeof h=="function")for(let x of z(h))!J.call(l,x)&&x!==P&&W(l,x,{get:()=>h[x],enumerable:!(m=Y(h,x))||m.enumerable});return l},q=(l,h,P)=>(H(l,h,"default"),P&&H(P,h,"default"));var Z=l=>H(W({},"__esModule",{value:!0}),l);var F={};import*as lt from"async_hooks";var V=Q(()=>{q(F,lt)});import{__getNamedExports as ee}from"../../../__next-on-pages-dist__/webpack/9802cf9bbc098bad310494fcc153465f.js";import{__getNamedExports as te}from"../../../__next-on-pages-dist__/manifest/27d10e462fba646daaa29468a0656e12.js";import"../../../__next-on-pages-dist__/wasm/wasm_848bce377ad47c933e205bdb413ae8af5ac0ccf0.wasm";var b=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/scores"),t=ee(b,b,b),ne=t.__chunk_1146,_e=t.__chunk_6195,ae=t.__chunk_2067,re=t.__chunk_5486,se=t.__chunk_7223,oe=t.__chunk_1548,ce=t.__chunk_2780,ue=t.__chunk_5612,ie=t.__chunk_2262,de=t.__chunk_1465,le=t.__chunk_1869,he=t.__chunk_5524,pe=t.__chunk_8536,ke=t.__chunk_6765,ye=t.__chunk_9814,fe=t.__chunk_9859,ge=t.__chunk_9307,me=t.__chunk_74,xe=t.__chunk_4123,Ne=t.__chunk_3412,ve=t.__chunk_8978,Ee=t.__chunk_1812,Ie=t.__chunk_1673,Re=t.__chunk_7398,Te=t.__chunk_5376,be=t.__chunk_6617,we=t.__chunk_5767,Oe=t.__chunk_8260,je=t.__chunk_5027,Ae=t.__chunk_2738,Se=t.__chunk_2113,Pe=t.__chunk_5065,Me=t.__chunk_5514,Ce=t.__chunk_2860,Fe=t.__chunk_5257,$e=t.__chunk_8427,De=t.__chunk_8997,Le=t.__chunk_8024,Ue=t.__chunk_2403,Be=t.__chunk_8690,Ke=t.__chunk_6265,He=t.__chunk_5492,qe=t.__chunk_3059,Ge=t.__chunk_8610,Xe=t.__chunk_7959,We=t.__chunk_4303,Ve=t.__chunk_3326,Ye=t.__chunk_391,ze=t.__chunk_8789,Je=t.__chunk_552,Qe=t.__chunk_7649,Ze=t.__chunk_2501,et=t.__chunk_6443,tt=t.__chunk_1616,nt=t.__chunk_2034,_t=t.__chunk_3131,at=t.__chunk_2328,rt=t.__chunk_8908,st=t.__chunk_1713,ot=t.__chunk_1172,G=te(b,b,b),ct=G.__NEXT_FONT_MANIFEST,ut=G.__REACT_LOADABLE_MANIFEST,it=G.__BUILD_MANIFEST,ft=((l,h,P)=>(h._ENTRIES={},l.__BUILD_MANIFEST=it,l.__REACT_LOADABLE_MANIFEST=ut,l.__NEXT_FONT_MANIFEST=ct,l.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",l.__PRERENDER_MANIFEST='{"version":4,"routes":{"/":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/page,_N_T_/"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/","dataRoute":"/index.rsc"},"/scores/import":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/scores/layout,_N_T_/scores/import/layout,_N_T_/scores/import/page,_N_T_/scores/import"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/scores/import","dataRoute":"/scores/import.rsc"},"/management":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/management/layout,_N_T_/management/page,_N_T_/management"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/management","dataRoute":"/management.rsc"},"/analysis/student":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/analysis/layout,_N_T_/analysis/student/layout,_N_T_/analysis/student/page,_N_T_/analysis/student"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/analysis/student","dataRoute":"/analysis/student.rsc"},"/analysis/class":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/analysis/layout,_N_T_/analysis/class/layout,_N_T_/analysis/class/page,_N_T_/analysis/class"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/analysis/class","dataRoute":"/analysis/class.rsc"},"/scores/add":{"initialHeaders":{"x-next-cache-tags":"_N_T_/layout,_N_T_/scores/layout,_N_T_/scores/add/layout,_N_T_/scores/add/page,_N_T_/scores/add"},"experimentalBypassFor":[{"type":"header","key":"Next-Action"},{"type":"header","key":"content-type","value":"multipart/form-data;.*"}],"initialRevalidateSeconds":false,"srcRoute":"/scores/add","dataRoute":"/scores/add.rsc"}},"dynamicRoutes":{},"notFoundRoutes":[],"preview":{"previewModeId":"process.env.__NEXT_PREVIEW_MODE_ID","previewModeSigningKey":"process.env.__NEXT_PREVIEW_MODE_SIGNING_KEY","previewModeEncryptionKey":"process.env.__NEXT_PREVIEW_MODE_ENCRYPTION_KEY"}}',(()=>{"use strict";var m={},x={};function s(n){var u=x[n];if(u!==void 0)return u.exports;var r=x[n]={id:n,loaded:!1,exports:{}},p=!0;try{m[n](r,r.exports,s),p=!1}finally{p&&delete x[n]}return r.loaded=!0,r.exports}s.m=m,s.amdO={},(()=>{var n=[];s.O=(u,r,p,k)=>{if(r){k=k||0;for(var i=n.length;i>0&&n[i-1][2]>k;i--)n[i]=n[i-1];n[i]=[r,p,k];return}for(var o=1/0,i=0;i<n.length;i++){for(var[r,p,k]=n[i],f=!0,E=0;E<r.length;E++)o>=k&&Object.keys(s.O).every(S=>s.O[S](r[E]))?r.splice(E--,1):(f=!1,k<o&&(o=k));if(f){n.splice(i--,1);var I=p();I!==void 0&&(u=I)}}return u}})(),s.n=n=>{var u=n&&n.__esModule?()=>n.default:()=>n;return s.d(u,{a:u}),u},(()=>{var n,u=Object.getPrototypeOf?r=>Object.getPrototypeOf(r):r=>r.__proto__;s.t=function(r,p){if(1&p&&(r=this(r)),8&p||typeof r=="object"&&r&&(4&p&&r.__esModule||16&p&&typeof r.then=="function"))return r;var k=Object.create(null);s.r(k);var i={};n=n||[null,u({}),u([]),u(u)];for(var o=2&p&&r;typeof o=="object"&&!~n.indexOf(o);o=u(o))Object.getOwnPropertyNames(o).forEach(f=>i[f]=()=>r[f]);return i.default=()=>r,s.d(k,i),k}})(),s.d=(n,u)=>{for(var r in u)s.o(u,r)&&!s.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:u[r]})},s.e=()=>Promise.resolve(),s.g=function(){if(typeof h=="object")return h;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),s.o=(n,u)=>Object.prototype.hasOwnProperty.call(n,u),s.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},s.nmd=n=>(n.paths=[],n.children||(n.children=[]),n),(()=>{var n={993:0};s.O.j=p=>n[p]===0;var u=(p,k)=>{var i,o,[f,E,I]=k,O=0;if(f.some(C=>n[C]!==0)){for(i in E)s.o(E,i)&&(s.m[i]=E[i]);if(I)var M=I(s)}for(p&&p(k);O<f.length;O++)o=f[O],s.o(n,o)&&n[o]&&n[o][0](),n[o]=0;return s.O(M)},r=l.webpackChunk_N_E=l.webpackChunk_N_E||[];r.forEach(u.bind(null,0)),r.push=u.bind(null,r.push.bind(r))})()})(),(l.webpackChunk_N_E=l.webpackChunk_N_E||[]).push([[962],{1172:ot,1713:st,8908:rt,2328:at,3131:_t,2034:nt,1616:tt,6443:et,2501:Ze,7649:Qe,552:Je,8789:ze,391:Ye,3326:Ve,4303:We,7959:Xe,8610:Ge,3059:qe,5492:He,6265:Ke,8690:Be,2403:Ue,8024:Le,8997:De,8427:$e,5257:Fe,2860:Ce,5514:Me,5065:Pe,2113:Se,2738:Ae,5027:je,8260:Oe,5767:we,6617:be,5376:Te,7398:Re,1673:Ie,1812:Ee,8978:ve,3412:Ne,4123:xe,74:me,9307:ge,9859:fe,9814:ye,6765:ke,8536:pe,5524:he,1869:le,1465:de,2262:ie,5612:ue,2780:ce,1548:oe,7223:se,5486:re}]),(l.webpackChunk_N_E=l.webpackChunk_N_E||[]).push([[257],{2067:ae,6195:_e,7993:(m,x,s)=>{"use strict";s.r(x),s.d(x,{ComponentMod:()=>B,default:()=>K});var n={};s.r(n),s.d(n,{DELETE:()=>C,GET:()=>I,POST:()=>O,PUT:()=>M,runtime:()=>E});var u={};s.r(u),s.d(u,{originalPathname:()=>L,patchFetch:()=>U,requestAsyncStorage:()=>S,routeModule:()=>j,serverHooks:()=>D,staticGenerationAsyncStorage:()=>$});var r=s(8260),p=s(5514),k=s(2860),i=s(2113),o=s(5492),f=s(1146);let E="edge";async function I(v,N){let d=(0,f.N)(N);try{let e=await d.score.findMany({include:{student:{include:{class:!0}},exam:!0},orderBy:{createdAt:"desc"}});return o.xk.json(e)}catch(e){return console.error("\u83B7\u53D6\u6210\u7EE9\u6570\u636E\u5931\u8D25:",e),o.xk.json({error:"\u83B7\u53D6\u6210\u7EE9\u6570\u636E\u5931\u8D25"},{status:500})}finally{N?.env?.DB||await d.$disconnect()}}async function O(v,N){let d=(0,f.N)(N);try{let{studentId:e,examId:c,subject:a,score:_}=await v.json();if(!e||!c||!a||_===void 0)return o.xk.json({error:"\u7F3A\u5C11\u5FC5\u8981\u5B57\u6BB5"},{status:400});if(_<0||_>100)return o.xk.json({error:"\u6210\u7EE9\u5FC5\u987B\u57280-100\u4E4B\u95F4"},{status:400});if(await d.score.findFirst({where:{studentId:parseInt(e),examId:parseInt(c),subject:a}}))return o.xk.json({error:"\u8BE5\u5B66\u751F\u5728\u6B64\u8003\u8BD5\u7684\u8BE5\u79D1\u76EE\u6210\u7EE9\u5DF2\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\u800C\u975E\u91CD\u590D\u5F55\u5165"},{status:409});let g=await d.score.create({data:{studentId:parseInt(e),examId:parseInt(c),subject:a,score:parseFloat(_)},include:{student:{include:{class:!0}},exam:!0}});return o.xk.json(g,{status:201})}catch(e){return console.error("\u521B\u5EFA\u6210\u7EE9\u8BB0\u5F55\u5931\u8D25:",e),o.xk.json({error:"\u521B\u5EFA\u6210\u7EE9\u8BB0\u5F55\u5931\u8D25"},{status:500})}finally{N?.env?.DB||await d.$disconnect()}}async function M(v,N){let d=(0,f.N)(N);try{let{id:e,studentId:c,examId:a,subject:_,score:g}=await v.json();if(!e||!c||!a||!_||g===void 0)return o.xk.json({error:"\u7F3A\u5C11\u5FC5\u8981\u5B57\u6BB5"},{status:400});if(g<0||g>100)return o.xk.json({error:"\u6210\u7EE9\u5FC5\u987B\u57280-100\u4E4B\u95F4"},{status:400});let y=await d.score.findUnique({where:{id:parseInt(e)}});if(!y)return o.xk.json({error:"\u6210\u7EE9\u8BB0\u5F55\u4E0D\u5B58\u5728"},{status:404});if((y.studentId!==parseInt(c)||y.examId!==parseInt(a)||y.subject!==_)&&await d.score.findFirst({where:{studentId:parseInt(c),examId:parseInt(a),subject:_,id:{not:parseInt(e)}}}))return o.xk.json({error:"\u8BE5\u5B66\u751F\u5728\u6B64\u8003\u8BD5\u7684\u8BE5\u79D1\u76EE\u6210\u7EE9\u5DF2\u5B58\u5728"},{status:409});let R=await d.score.update({where:{id:parseInt(e)},data:{studentId:parseInt(c),examId:parseInt(a),subject:_,score:parseFloat(g)},include:{student:{include:{class:!0}},exam:!0}});return o.xk.json(R)}catch(e){return console.error("\u66F4\u65B0\u6210\u7EE9\u8BB0\u5F55\u5931\u8D25:",e),o.xk.json({error:"\u66F4\u65B0\u6210\u7EE9\u8BB0\u5F55\u5931\u8D25"},{status:500})}finally{N?.env?.DB||await d.$disconnect()}}async function C(v,N){let d=(0,f.N)(N);try{let e=v.nextUrl.searchParams.get("id");return e?await d.score.findUnique({where:{id:parseInt(e)}})?(await d.score.delete({where:{id:parseInt(e)}}),o.xk.json({message:"\u6210\u7EE9\u8BB0\u5F55\u5220\u9664\u6210\u529F"},{status:200})):o.xk.json({error:"\u6210\u7EE9\u8BB0\u5F55\u4E0D\u5B58\u5728"},{status:404}):o.xk.json({error:"\u7F3A\u5C11\u6210\u7EE9\u8BB0\u5F55ID"},{status:400})}catch(e){return console.error("\u5220\u9664\u6210\u7EE9\u8BB0\u5F55\u5931\u8D25:",e),o.xk.json({error:"\u5220\u9664\u6210\u7EE9\u8BB0\u5F55\u5931\u8D25"},{status:500})}finally{N?.env?.DB||await d.$disconnect()}}let j=new p.AppRouteRouteModule({definition:{kind:k.x.APP_ROUTE,page:"/api/scores/route",pathname:"/api/scores",filename:"route",bundlePath:"app/api/scores/route"},resolvedPagePath:"/Users/ryan/demo2/AI/Grade_M2/src/app/api/scores/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:S,staticGenerationAsyncStorage:$,serverHooks:D}=j,L="/api/scores/route";function U(){return(0,i.XH)({serverHooks:D,staticGenerationAsyncStorage:$})}let B=u,K=r.a.wrap(j)},1146:ne},m=>{var x=n=>m(m.s=n);m.O(0,[962],()=>x(7993));var s=m.O();(h._ENTRIES=typeof h._ENTRIES>"u"?{}:h._ENTRIES)["middleware_app/api/scores/route"]=s}]),function(){let m={exports:{},loaded:!1};return function(s,n){var u=Object.create,r=Object.defineProperty,p=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyNames,i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,f=e=>r(e,"__esModule",{value:!0}),E=(e,c)=>{f(e);for(var a in c)r(e,a,{get:c[a],enumerable:!0})},I=(e,c,a)=>{if(c&&typeof c=="object"||typeof c=="function")for(let _ of k(c))!o.call(e,_)&&_!=="default"&&r(e,_,{get:()=>c[_],enumerable:!(a=p(c,_))||a.enumerable});return e},O=e=>I(f(r(e!=null?u(i(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);E(n,{default:()=>K});var M=O((V(),Z(F))),C="@next/request-context",j=Symbol.for(C),S=Symbol.for("internal.storage");function $(){let e=h;if(!e[j]){let c=new M.AsyncLocalStorage,a={get:()=>c.getStore(),[S]:c};e[j]=a}return e[j]}var D=$();function L(e,c){return D[S].run(e,c)}function U(e){let c={};return e&&e.forEach((a,_)=>{c[_]=a,_.toLowerCase()==="set-cookie"&&(c[_]=B(a))}),c}function B(e){let c=[],a=0,_,g,y,R,A;function T(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}function w(){return g=e.charAt(a),g!=="="&&g!==";"&&g!==","}for(;a<e.length;){for(_=a,A=!1;T();)if(g=e.charAt(a),g===","){for(y=a,a+=1,T(),R=a;a<e.length&&w();)a+=1;a<e.length&&e.charAt(a)==="="?(A=!0,a=R,c.push(e.substring(_,y)),_=a):a=y+1}else a+=1;(!A||a>=e.length)&&c.push(e.substring(_,e.length))}return c}function K(e){let c=e.staticRoutes.map(_=>({regexp:new RegExp(_.namedRegex),page:_.page})),a=e.dynamicRoutes?.map(_=>({regexp:new RegExp(_.namedRegex),page:_.page}))||[];return async function(_,g){let y=new URL(_.url).pathname,R={};if(e.nextConfig?.basePath&&y.startsWith(e.nextConfig.basePath)&&(y=y.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let T of e.nextConfig.i18n.locales){let w=new RegExp(`^/${T}($|/)`,"i");if(y.match(w)){y=y.replace(w,"/")||"/";break}}for(let T of c)if(T.regexp.exec(y)){R.name=T.page;break}if(!R.name){let T=N(y);for(let w of a||[]){if(T&&!N(w.page))continue;let X=w.regexp.exec(y);if(X){R={name:w.page,params:X.groups};break}}}let A=await L({waitUntil:g.waitUntil},()=>h._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:_.url,method:_.method,headers:U(_.headers),ip:v(_.headers,d.Ip),geo:{city:v(_.headers,d.City,!0),country:v(_.headers,d.Country,!0),latitude:v(_.headers,d.Latitude),longitude:v(_.headers,d.Longitude),region:v(_.headers,d.Region,!0)},nextConfig:e.nextConfig,page:R,body:_.body}}));return A.waitUntil&&g.waitUntil(A.waitUntil),A.response}}function v(e,c,a=!1){let _=e.get(c)||void 0;return a&&_?decodeURIComponent(_):_}function N(e){return e==="/api"||e.startsWith("/api/")}var d;(function(e){e.City="x-vercel-ip-city",e.Country="x-vercel-ip-country",e.Ip="x-real-ip",e.Latitude="x-vercel-ip-latitude",e.Longitude="x-vercel-ip-longitude",e.Region="x-vercel-ip-country-region"})(d||(d={}))}(m,m.exports),m.exports}.call({}).default({name:"app/api/scores/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/analysis/class",regex:"^/analysis/class(?:/)?$",routeKeys:{},namedRegex:"^/analysis/class(?:/)?$"},{page:"/analysis/student",regex:"^/analysis/student(?:/)?$",routeKeys:{},namedRegex:"^/analysis/student(?:/)?$"},{page:"/management",regex:"^/management(?:/)?$",routeKeys:{},namedRegex:"^/management(?:/)?$"},{page:"/scores/add",regex:"^/scores/add(?:/)?$",routeKeys:{},namedRegex:"^/scores/add(?:/)?$"},{page:"/scores/import",regex:"^/scores/import(?:/)?$",routeKeys:{},namedRegex:"^/scores/import(?:/)?$"}],dynamicRoutes:[],nextConfig:{basePath:""}})))(b,b,b);export{ft as default};
